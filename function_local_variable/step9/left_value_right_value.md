# 左邊值與右邊值

代入式和其他的二項運算子不同，左邊的值需要進行特別的處理，本結針對此部份進行說明。

代入式的左邊並不是任何式子都可以放。舉例來說，像`1=2`這樣把`1`用`2`代入就是不行的。像`a=2`這樣的代入是可以的，但是像`(a+1)=2`這樣的式子就是不合規定的。9cc 現在仍沒有指標的資料結構，但要是存在的話，像`*p=2`這樣代入指標指向的目的、或是像`a.b=2`這樣代進結構成員，需要作為合法的帶入被允許。到底要如何區分像前述合法的式子和不合法的式子呢？

這個問題的答案非常簡單。在C語言中，可以放在代入式左邊的，基本上只有指向記憶體位址的式子而已。

變數在記憶體裏面，理所當然有記憶體位址，所以可以寫在代入式的左側。同理，像`*p`這樣的指標參照也一樣，`p`的值被用來指向記憶體位址，所以也可以寫在左側。`a.b`這樣結構成員的存取也是，是指向在記憶體中`a`這個結構的開始位置算起，加上前進到成員`b`為止的偏移量後的記憶體位址，所以也可以寫在左側。

然而，像`a+1`這樣算式的結果，並不是變數，無法作為指定記憶體位址的式子使用。像這樣暫時的值，只存在在暫存器中而不在記憶體上，而且，就算在記憶體上，一般來說是不能存取從變數起算固定偏移量的位置的。根據以上理由，就算寫`&(a+1)`，也會因為無法取得`a+1`結果的位址，而發生編譯錯誤。像這樣的式子是不能寫在代入式的左側的。

可以寫在左側的值稱為左邊值（left value），除此之外的值稱為右邊值（right value）。左邊值和右邊值也可以稱為 lvalue、rvalue。在我們現在的語言中，只有變數是左邊值，除此之外的值全部都是右邊值。

在產生變數的指令的時候，可以以左邊值為起點思考。在代入的左邊出現變數時，變數的位址作為左側的值被計算出來，並且把右側的結果存入該位址。像這樣，就可實作出代入式。變數如果出現在左側以外的地方時，只要在同樣計算出變數的位址後，把該位址的值讀出，就可以把左邊值轉變成右邊值使用。如此，就可以取得變數的值。

